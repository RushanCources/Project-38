{% extends 'base.html' %}


{% block content %}
{% load static %}
<style>
	 #main {
        display: none;
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
      }
	  #main:target {display: block;}
      #zatemnenie {
        background: rgba(102, 102, 102, 0.5);
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
        display: none;
      }
      #okno {
        width: 300px;
        height: 50px;
        text-align: center;
        padding: 15px;
        border: 3px solid #0000cc;
        border-radius: 10px;
        color: #0000cc;
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
        margin: auto;
        background: #fff;
      }
      #zatemnenie:target {display: block;}
      .close {
        display: inline-block;
        border: 1px solid #0000cc;
        color: #0000cc;
        padding: 0 12px;
        margin: 10px;
        text-decoration: none;
        background: #f2f2f2;
        font-size: 14pt;
        cursor:pointer;
      }
      .close:hover {background: #e6e6ff;}
    </style>
<title xmlns="http://www.w3.org/1999/html">{{ name }}</title>
    <form method="POST" action="{% url 'correct_project' %}" id="form_name">
        {% csrf_token %}
        <input type="hidden" name="project" value={{project_id}}>
        <textarea id="name" name="name" disabled class="form-control">{{name}}</textarea>
    </form>
    <button onclick="return edit(this, 'name')" style="background-color: #FFFFF">
        <img src="{% static 'edit.png' %}" style="width: 20px; height: 20px"/>
    </button>
    <div>{{teacher}}</div>
    <div>{{student}}</div>
    <div>{{status}}</div>
    <form method="POST" action="{% url 'correct_project' %}" id="form_description">
        {% csrf_token %}
        <input type="hidden" name="project" value={{project_id}}>
        <textarea id="description" name="description" class="form-control" disabled >{{description}}</textarea>
    </form>
    <button onclick="return edit(this, 'description')" style="background-color: #FFFFF">
        <img src="{% static 'edit.png' %}" style="width: 20px; height: 20px"/>
    </button>
    <a href="{% url 'trash' %}?project_id={{project_id}}">Корзина</a>
    {% for files_pack in files_packs %}
        <div>
            <div>{{files_pack.name}}</div>
            <form  method="POST" action="{% url 'update_file' %}" enctype="multipart/form-data">
                {% csrf_token %}
                <input type="hidden" name="file_id" value={{files_pack.file.id}} />
                <div>
                <label for="input-file{{files_pack.file.id}}">Обновить файл</label>
                <input type="file" id="input-file{{files_pack.file.id}}" name="file" style="display:none; visibility:hidden"/>
                <!-- В стили потом нужно для этой кнопки перенести два свойства display:none и visibility:hidden
                    с теми атрибутами, что сейчас прикручены напрямую -->
            </div>
            </form>
            <form  method="POST" action="{% url 'delete_file' %}">
                {% csrf_token %}
                <input type="hidden" name="file_id" value={{files_pack.file.id}} />
                <label for="delete_file{{file.id}}">Удалить файл</label>
                <input type="submit" id="delete_file{{files_pack.file.id}}" name="file" style="display:none; visibility:hidden"/>
            </form>
            <a href="{% url 'download_file' %}?file_id={{files_pack.file.id}}">Загрузить файл</a>
            <a href="#" class="main">
                <div id="zatemnenie">
                    <div id="okno">
                        Предыдущие версии файла<br>

                    </div>
                </div>
            </a>
            <a href="#zatemnenie">Предыдущие версии файла</a>
        </div>

    {% endfor %}

    <form method="POST" action="{% url 'add_file' %}"  enctype="multipart/form-data">
        {% csrf_token %}
        <input type="hidden" name="project_id" value={{project_id}}>
        <label for="add_file">Добавить файл</label>
        <input type="file" id="add_file" onchange="this.parentElement.submit()" style="display:none; visibility:hidden" name="files"/>
    </form>
    <script>

        function edit(elem, id){
            let f = document.getElementById(id);
            f.disabled = false;
            elem.setAttribute( "onclick", "return save('"+id+"')");
            elem.childNodes[1].src = "{% static 'tick.png' %}";
            elem.style.backgroundColor = "#2DA44E";
            }

        function save(id){
            let f = document.getElementById(id);
            let form = document.getElementById("form_"+id);
            form.submit();
            }
    </script>
{% endblock %}